simple_oauth_server_metadata.well_known:
  path: '/.well-known/oauth-authorization-server'
  defaults:
    _controller: '\Drupal\simple_oauth_server_metadata\Controller\ServerMetadataController::__invoke'
    _title: 'OAuth 2.0 Authorization Server Metadata'
  methods: [GET]
  requirements:
    # Public metadata endpoint - RFC 8414 requires this to be accessible.
    _access: 'TRUE'
  options:
    _format: 'json'
    no_cache: FALSE

simple_oauth_server_metadata.resource_metadata:
  path: '/.well-known/oauth-protected-resource'
  defaults:
    _controller: '\Drupal\simple_oauth_server_metadata\Controller\ResourceMetadataController::__invoke'
    _title: 'OAuth 2.0 Protected Resource Metadata'
  methods: [GET]
  requirements:
    # Public metadata endpoint - RFC 9728 requires this to be accessible.
    _access: 'TRUE'
  options:
    _format: 'json'
    no_cache: FALSE

simple_oauth_server_metadata.openid_configuration:
  path: '/.well-known/openid-configuration'
  defaults:
    _controller: '\Drupal\simple_oauth_server_metadata\Controller\OpenIdConfigurationController::configuration'
    _title: 'OpenID Connect Discovery'
  methods: [GET]
  requirements:
    # OpenID Connect Discovery endpoint must be publicly accessible for client discovery.
    _access: 'TRUE'
  options:
    _format: 'json'
    no_cache: FALSE

simple_oauth_server_metadata.revoke:
  path: '/oauth/revoke'
  defaults:
    _controller: '\Drupal\simple_oauth_server_metadata\Controller\TokenRevocationController::revoke'
    _title: 'OAuth 2.0 Token Revocation'
  methods: [POST]
  requirements:
    # Made accessible because there is custom authorization in the controller, as per RFC 7009.
    _access: 'TRUE'

simple_oauth_server_metadata.settings:
  path: '/admin/config/people/simple_oauth/oauth-21/server-metadata'
  defaults:
    _form: '\Drupal\simple_oauth_server_metadata\Form\ServerMetadataSettingsForm'
    _title: 'Server Metadata Settings'
  requirements:
    _permission: 'administer simple_oauth entities'
  options:
    _admin_route: TRUE
